steps:
  STG_TEXT_FILE_PARSED-6546:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: STAGE
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 65849
              stepCounter: "6546"
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: METADATA$FILENAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 65685
                    stepCounter: "6535"
                transform: ""
          - columnReference:
              columnCounter: 65861
              stepCounter: "6546"
            dataType: INT
            description: ""
            name: RN
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 65856
                    stepCounter: "6535"
                transform: ""
          - columnReference:
              columnCounter: 65850
              stepCounter: "6546"
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: c1
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 65686
                    stepCounter: "6535"
                transform: ""
          - columnReference:
              columnCounter: 65851
              stepCounter: "6546"
            dataType: STRING
            description: ""
            name: country
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 65815
                    stepCounter: "6544"
                transform: ""
          - columnReference:
              columnCounter: 65852
              stepCounter: "6546"
            dataType: STRING
            description: ""
            name: first_name
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 65848
                    stepCounter: "6545"
                transform: ""
          - columnReference:
              columnCounter: 65853
              stepCounter: "6546"
            dataType: STRING
            description: ""
            name: gender
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 65758
                    stepCounter: "6542"
                transform: ""
          - columnReference:
              columnCounter: 65854
              stepCounter: "6546"
            dataType: STRING
            description: ""
            name: title
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 65785
                    stepCounter: "6543"
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 65855
              stepCounter: "6546"
            config: {}
            dataType: STRING
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: comment_text
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0
                    stepCounter: "0"
                transform: |
                  REPLACE(CASE WHEN "STG_TEXT_COUNTRY"."country" IS NULL THEN 'NO COUNTRY,' ELSE '' END ||
                  CASE WHEN "STG_TEXT_FIRST_NAME"."first_name" IS NULL THEN 'NO NAME,' ELSE '' END ||
                  CASE WHEN "STG_TEXT_GENDER"."gender" IS NULL THEN 'NO GENDER,' ELSE '' END ||
                  CASE WHEN "STG_TEXT_TITLE"."title" IS NULL THEN 'NO TITLE,' ELSE '' END ||'|', ',|', '')
            systemColumnType: None
            transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              STG_TEXT_COUNTRY: "6544"
              STG_TEXT_FILE: "6535"
              STG_TEXT_FIRST_NAME: "6545"
              STG_TEXT_GENDER: "6542"
              STG_TEXT_TITLE: "6543"
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: STAGE
                nodeName: STG_TEXT_FILE
              - locationName: STAGE
                nodeName: STG_TEXT_GENDER
              - locationName: STAGE
                nodeName: STG_TEXT_TITLE
              - locationName: STAGE
                nodeName: STG_TEXT_COUNTRY
              - locationName: STAGE
                nodeName: STG_TEXT_FIRST_NAME
            join:
              joinCondition: |-
                
                FROM {{ ref('STAGE','STG_TEXT_FILE') }} "STG_TEXT_FILE"
                LEFT JOIN {{ ref('STAGE', 'STG_TEXT_GENDER') }} "STG_TEXT_GENDER"
                ON "STG_TEXT_FILE"."RN" = "STG_TEXT_GENDER"."RN"
                LEFT JOIN {{ ref('STAGE', 'STG_TEXT_TITLE') }} "STG_TEXT_TITLE"
                ON "STG_TEXT_FILE"."RN" = "STG_TEXT_TITLE"."RN"
                LEFT JOIN {{ ref('STAGE', 'STG_TEXT_COUNTRY') }} "STG_TEXT_COUNTRY"
                ON "STG_TEXT_FILE"."RN" = "STG_TEXT_COUNTRY"."RN"
                LEFT JOIN {{ ref('STAGE', 'STG_TEXT_FIRST_NAME') }} "STG_TEXT_FIRST_NAME"
                ON "STG_TEXT_FILE"."RN" = "STG_TEXT_FIRST_NAME"."RN"
            name: STG_TEXT_FILE_PARSED
            noLinkRefs: []
      name: STG_TEXT_FILE_PARSED
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: "6546"
